/* for loop generator */#include <stdio.h>#include <signal.h>#asm        info    UniFLEX for loop        info    V1.2 oktober 1988        info    by Wijnand Lekkerkerker#endasmmain(argc, argv)int argc;char *argv[];{        char    **argl;        char    *expand();        int     ci, i, j, k;        int     child, st;        int     wp, oldint;        if (argc < 6)                usage();        ci = 0;        for (i=1; i<argc; i++) {                /* find do */                if (strcmp("do", argv[i]))                        continue;                ci = i+1;        }        if (ci+1 >= argc || argc == 0)                usage();        argl = malloc((argc - ci) * sizeof(char *));        argl[0] = argv[ci];        for (i=1; i<argc; i++) {                /* find do */                if (!strcmp("do", argv[i]))                        break;                for (j=ci+1,k=1; j<argc; j++,k++) {   /* expand args */                        argl[k] = expand(argv[i], argv[j]);                }                argl[k] = 0;                if ((child = fork()) == 0) {                         st = execvp(argv[ci], argl);    /* child */                        exit(st);                       /* bad exec */                } else {                                /* parent */                        oldint = signal(SIGINT, SIG_IGN);                        while ((wp = wait(&st)) != -1 && wp != child)                                ;               /* parent wait for child */                        signal(SIGINT, oldint);         /* default */                }                if (st)                        printf("for: bad exit status %d\n", st);        }}usage(){        printf("Usage: for <name_list> do <command> $\n");        exit(1);}char *expand(nam, pro)char    *nam;char    *pro;{        char    *bf, *rp;        int     l;        if ((rp = index(pro, '$')) == 0)                return pro;        if ((l = strlen(pro)) == 1)                return nam;        bf = malloc(l + strlen(nam));        strcpy(bf, pro);        strcpy(index(bf, '$'), nam);        strcat(bf, rp+1);        return bf;}