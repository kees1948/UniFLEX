#include <stdio.h>#include <sgtty.h>#include <termcap.h>#define TRUE 1#define FALSE 0#define INREADY 0x80#define ESCAPE 255 /* cursor control escape */#define XY 1       /* bit for row or column, on->column */#define BIAS 2     /* bit for bias */#define SUB 4      /* subtract from maximum */#define BCD 8      /* bit for BCD */#define ASCII 16   /* bit to send position in ASCII */#define NIL 0                   /* Null pointer */#define DIRSIZE 32              /* Terminal Directory Size */#define DATABYTES 4             /* Number of bytes before pointers */struct sgttyb ttybuffer;struct ttycap cap;              /* Terminal capabilities */#define NUMCAP (sizeof(cap)-STRSIZE-DATABYTES)/sizeof(char *) main(argc, argv)int     argc;char    *argv[];{        if (termcap(&cap)==FALSE) {                puts("Can't initialize terminal", stdout);                exit(1);        }        if (cap.c_bs != NIL) {                gtty(stdin->_fd, &ttybuffer);                ttybuffer.sg_erase = cap.c_bs[0];                stty(stdin->_fd, &ttybuffer);        }}termcap(cp)             /* Get terminal capabilities */struct ttycap *cp;{        char    **cap_ptr;        int     i;        long    j;        int     fd;        int     direc[DIRSIZE];        long    lseek();        if ((fd=open("/etc/termcap",0)) == -1)                return FALSE;        if ((i=read(fd,(char *)direc,sizeof(int)*DIRSIZE)) == -1             || i != sizeof(int)*DIRSIZE             || (i=direc[ttyslot()]) == 0             || (j=lseek(fd, (long)i, 0)) == -1L             || (i=read(fd,(char *)cp,sizeof(struct ttycap))) == -1             || i != sizeof(struct ttycap)) {                close(fd);                return FALSE;        }        close(fd);        cap_ptr = (char **)( (char *)cp+DATABYTES );        for (i=NUMCAP; i--; cap_ptr++)                if (*cap_ptr != NIL)                        *cap_ptr += (unsigned)cp;        return TRUE;}