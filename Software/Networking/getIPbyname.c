#include <stdio.h>#include <net.h>#include <stdint.h>#include <errno.h>#define HOSTS  "/etc/hosts"#define MAX_HOSTS_LINE_LEN  63#define MAX_HOSTNAME_LEN    15uint32_t getIPbyname(hostname)char *hostname;{FILE *hp;int len, num;char mybuf[MAX_HOSTS_LINE_LEN+1];char fdn[MAX_HOSTS_LINE_LEN+1];char fl1[MAX_HOSTNAME_LEN+1];uint16_t ipn[4];        if((hp = fopen(HOSTS,"r")) == NULL)        {                return (-1);        }        while((fgets(mybuf, sizeof(mybuf)-1, hp)) != NULL)        {             if ((len = strlen(mybuf)) > MAX_HOSTS_LINE_LEN)             {                 return (-1);             }             if (mybuf[0] == '*')                     continue;/* last string MAX_HOSTNAME_LEN-1 */             if((num = sscanf(mybuf,"%d\.%d\.%d\.%d %s%*s",                     &ipn[0], &ipn[1],                     &ipn[2], &ipn[3],                     fdn)) <= 0)                continue;/* get hostname from FQDN */             sscanf(fdn,"%[^.]s%*s", fl1);             if( (strcmp(hostname,fdn) == 0)||                 (strcmp(hostname,fl1) == 0)               )             {                 fclose(hp);                 return((uint32_t) (                     ((uint32_t)((uint8_t)ipn[0]) <<24)|                     ((uint32_t)((uint8_t)ipn[1]) <<16)|                     ((uint32_t)((uint8_t)ipn[2]) <<8) |                     ((uint32_t)((uint8_t)ipn[3]) & 0xff)                                   )                             );             }        }        fclose(hp);        return(-1L);}