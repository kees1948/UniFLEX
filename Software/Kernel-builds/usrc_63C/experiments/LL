               0000  GPP       set    0                                          *       opt     nol                     *       lib     ../include/macdefs.h                     *       lib     ../include/dpr.h                               opt    exp                     *       opt     lis                                    E000  DPRFLP    equ    $e000                       0000                         data                                          *       lib     dpr.t                                                    opt    pag UniFLEX    Operating System (C)1     23:39:45  Dec 25, 2019   Page    1UniFLEX    Operating System (C)1     23:39:45  Dec 25, 2019   Page    2System     Parameters                                                                         *                     * System Parameters - adjust accordingly                     *                                    0003  DSKADS    equ    3         disk address size in bytes               000E  DIRSIZ    equ    14        directory entry size (name)               000C  SIGCNT    equ    12        number of system signals               000D  MAPSIZ    equ    13        file map size in fdn               1000  PAGSIZ    equ    4096      smallest allocated memory page               0200  BUFSIZ    equ    512       buffer size               0100  MAXPAG    equ    256       max 4K segments in mainframe               0100  SMAPSZ    equ    256       size of swap allocation area               0032  CFDN      equ    50        max in core fdns               0064  CDBLKS    equ    100       max in core disk blocks               0010  MAXPAGES  equ    16        Max 4K Pages in 64K               0009  RESTM     equ    9         max system residence time (ticks)               1000  MAXPIP    equ    4096      max data in a pipe (don't go over 5120!)               000A  DPLCNT    equ    10        data pool buffer count               0009  DPLSIZ    equ    9         data pool buffer size               0008  EXCSIZ    equ    8         size of exec name entry               0010  UNFILS    equ    16        max open files / user                     UniFLEX    Operating System (C)1     23:39:46  Dec 25, 2019   Page    3System     Parameters                                                                         * memory associated values                                    0000  SYSPAG    equ    $00       system page               0000  SYSLOC    equ    $00       system segment in system space               0001  STABPG    equ    $01       system table page               0005  SYSTXT    equ    $05       system text start               0009  DRVPAG    equ    $09       drivers segment               000B  USRLOC    equ    $0B       user segment in system space               000C  SBUF      equ    $0C       system buffer segment               000D  XBUF      equ    $0D       cross buffer segment               D000  XBUFFR    equ    XBUF<<12  cross buffer begin               C000  SBUFFR    equ    SBUF<<12  system buffer begin               0F3E  STKOFS    equ    $F3E      offset to usp/sysstk               BF3E  SYSSTK    equ    (USRLOC<<12)+STKOFS system stack per task               BF3E  USERBL    equ    (USRLOC<<12)+STKOFS user block location               000F  SYSBLK    equ    $0F       system page 0               0E00  USTKO     equ    $E00      user stack offset in ublock                                                                                    * character definitions                                    0009  TABCH     equ    $9        tab character               0020  SPACE     equ    $20       space character               000A  NL        equ    $a        new line               000D  CR        equ    $d        carriage return               001B  HOLDC     equ    $1b       ESC - suspend output               0011  XONC      equ    $11       XON - restart output               0013  XOFFC     equ    $13       XOFFF - suspend output               001C  QUITC     equ    $1c       FS character               0003  INTRC     equ    $03       DEL character               0004  EOTCH     equ    $04       EOT character               007F  BSPCH     equ    $7f       back space character               0018  CNCLC     equ    $18       line cancel char                                          * Constants                                    0080  EBIT      equ    %10000000 entire state status bit (cc)               0001  CBIT      equ    %00000001 carry bit in cc (error bit)               0008  REGSIZ    equ    8         space: CC, D, X, PC, PB                     *STKREG    equ     14    12         registers on stack size *** CPU ***               FFFF  NODEV     equ    -1        no device specifier                                          UniFLEX    Operating System (C)1     23:39:46  Dec 25, 2019   Page    4System     Parameters                                                                         * Register offset to SP                                    0000  UCC       equ    0         condition codes               0001  UA        equ    1         a register               0002  UB        equ    2         b register               0003  UX        equ    3         x register               0005  UPC       equ    5         pc register               0007  UPB       equ    7         os call post byte               0001  UD        equ    UA        d register                                          * signals                                    0001  HANGS     equ    1         hangup signal               0002  INTS      equ    2         interrupt signal               0003  QUITS     equ    3         quit signal               0004  EMTS      equ    4         emt trap signal (swi)               0005  KILLS     equ    5         kill signal               0006  WPIPES    equ    6         illegal pipe write signal                     * SWTPC vii special               0007  FALTS     equ    7         memory fault               0008  EMT2S     equ    8         emt2 trap (swi2)                     * non SWTPC vii               0007  BARGS     equ    7         bad argument signal               0008  TRACS     equ    8         trace job signal                     *               0009  TIMES     equ    9         time limit signal               000A  ALARMS    equ    10        alarm signal                                                               * priorities                                    0078  SWAPPR    equ    120       swap task               0064  FDNPR     equ    100       fdn update               0050  NFDNPR    equ    80        fdn wait priority               0032  BUFPR     equ    50        block io task               001E  WBUFPR    equ    30        buffer wait               FFFB  PIPEPR    equ    -5        pipe i/o               FFFB  WMEMPR    equ    -5        wait memory               FFF6  TTYIPR    equ    -10       tty wait               FFEC  TTYOPR    equ    -20       tty wait output               FFD8  WAITPR    equ    -40       task wait               FFB0  SLEPPR    equ    -80       sleeping               FFA6  USERPR    equ    -90       max user priority                                          UniFLEX    Operating System (C)1     23:39:46  Dec 25, 2019   Page    5System     Parameters                                                                         * errors                                    0001  EIO       equ    1         io error               0002  EFAULT    equ    2         system fault               0003  EDTOF     equ    3         data section overflow               0004  ENDR      equ    4         not a directory               0005  EDFUL     equ    5         disk full               0006  ETMFL     equ    6         too many files               0007  EBADF     equ    7         bad file               0008  ENOFL     equ    8         no file               0009  EMSDR     equ    9         missing directory               000A  EPRM      equ    10        file permission               000B  EFLX      equ    11        file exists               000C  EBARG     equ    12        bad argument               000D  ESEEK     equ    13        seek error               000E  EXDEV     equ    14        crossed devices               000F  ENBLK     equ    15        not a block special file               0010  EBSY      equ    16        device is busy               0011  ENMNT     equ    17        file not mounted               0012  EBDEV     equ    18        bad device specified               0013  EARGC     equ    19        too many arguments               0014  EISDR     equ    20        file is a directory               0015  ENOTB     equ    21        file not binary               0016  EBBIG     equ    22        binary file too big               0017  ESTOF     equ    23        stack overflow               0018  ENCHD     equ    24        no children living               0019  ETMTS     equ    25        too mant tasks active               001A  EBDCL     equ    26        bad system call               001B  EINTR     equ    27        interrupted system call               001C  ENTSK     equ    28        no task found               001D  ENTTY     equ    29        not a tty               001E  EPIPE     equ    30        write to broken pipe               001F  ELOCK     equ    31        record locking error  0000                         data                               opt    lisUniFLEX    Operating System (C)1     23:39:47  Dec 25, 2019   Page    6Dual_Port RAM Simulation Structure                                                 opt    lis                     *                     * -- As seen by Main 6809 CPU (UniFLEX)                     *                                    0200  DPRF_SIZ  equ    512       Size of FIFO buffer                       0000                         base   $0        -- Dual port RAM                     *  0000               dpr_cpu   rmb    1         DPR -> CPU Mailbox cell  0001               dpr_cpu1  rmb    1         -- Additional cell  0002               dpr_cpu2  rmb    1         --  0003               dpr_cpu3  rmb    1         --  0004               dpr_cpu4  rmb    1  0005               dpr_cpu5  rmb    1  0006               dpr_cpu6  rmb    1  0007               dpr_cpu7  rmb    1                     *  0008               cpu_dpr   rmb    1         CPU -> DPR Mailbox cell  0009               cpu_dpr1  rmb    1         -- Additional cell  000A               cpu_dpr2  rmb    1         --  000B               cpu_dpr3  rmb    1         --  000C               cpu_dpr4  rmb    1  000D               cpu_dpr5  rmb    1  000E               cpu_dpr6  rmb    1  000F               cpu_dpr7  rmb    1                     *  0010               dpr_f_cnt rmb    1         Count of data in FIFO  0011               dpr_f_get rmb    2         FIFO consumer pointer  0013               dpr_f_put rmb    2         FIFO producer pointer  0015                         rmb    32-(*-dpr_cpu) ** Filler **                     *  0020               dprf      rmb    DPRF_SIZ  actual FIFO  0220                         rmb    $400-4-(*-dpr_cpu)                     *  03FC               dpr_fgpp  rmb    1         debug data from GPP  03FD               dpr_tgpp  rmb    1         debug data to GPP  03FE               dpr_cpuF  rmb    1         Non-zero when mailbox has data                               if     UniFLEX   * UniFLEX***  Undefined symbol               03FF  dpr_gen   equ    *         IRQ generator cell  03FF               cpu_dprF  rmb    1         Non-zero when mailbox has data                                          *                     * DPR Task Priority                     *   -- Set to make task uninterruptable while                     *   -- actually using the DPR                     *               000F  DPRPRI    set    15                                          *                     * DPR Control structuresUniFLEX    Operating System (C)1     23:39:48  Dec 25, 2019   Page    7FIO Simulation Structure                                                 *               0014  DPR_MXTR  equ    20        # concurrent transactions / GPP                     * IOP Control  0000                         base   0  0000               dpr_mbx   rmb    2         Mailbox interlock - Task id of locker  0002               dpr_fifo  rmb    2         FIFO interlock - Task id of locker  0004               dpr_intc  rmb    1         Set non-zero if message interrupt was missed  0005               dpr_tflg  rmb    1         Waiting on transaction slot semaphore  0006               dpr_Q     rmb    4         Input response queue  000A               dpr_dba   rmb    2         dual port ram base address  000C               dpr_tran  rmb    DPR_MXTR*TRAN_SIZE transaction slots                     *               0084  DPR_SIZE  equ    *                     *                     * IOP ROM Version #                     *               0012  ROM_VERSION equ  $12       Major/Minor Version of IOP ROM                                          *                     * Error codes                     *               0080  REJECT    equ    %10000000 Error/Reject bit in command response               0081  E_BADCMD  equ    REJECT+$01 Illegal command               0082  E_SYSBSY  equ    REJECT+$02 IOP saturated               0083  E_NTOPEN  equ    REJECT+$03 Selected device not open               0084  E_BADDEV  equ    REJECT+$04 Illegal device # (=3)               0085  E_DEVBSY  equ    REJECT+$05 Device is already open (exclusieve)               0086  E_IOERR   equ    REJECT+$06 Some osrt of IO error               00BE  E_INTRPT  equ    REJECT+$3E Terminal interrupt (send by IOP to UniFLEX)               00BF  E_ABORT   equ    REJECT+$3F Transaction aborted by UniFLEX (not sent by IOP)                                          *                     * Normal responses                     *               0001  R_RESET   equ    $01       System reset & functioning               0002  R_OPEN    equ    $02       Device open successful               0003  R_CLOSE   equ    $03       Device close successful               0004  R_REQOK   equ    $04       Write request now granted               0005  R_WRITE   equ    $05       Write data complete               0006  R_TTY     equ    $06       TTYSET/GET complete               0007  R_RDOK    equ    $07       Read data now available               0008  R_SNDNC   equ    $08       Read data in FIFO & no more data is available               0009  R_RD1C    equ    $09       Single character available               000A  R_INTRPT  equ    $0A       Interrupt complete               000B  R_SNDMC   equ    $0B       Read data in FIFO & there is more available                                          *                     * Request codes (from Main CPU)                     *               0010  O_OPEN    equ    $10       Open device               0020  O_CLOSE   equ    $20       Close device               0030  O_TTYS    equ    $30       TTY SetUniFLEX    Operating System (C)1     23:39:48  Dec 25, 2019   Page    8FIO Simulation Structure                                           0040  O_TTYG    equ    $40       TTY Get               0050  O_RQWR    equ    $50       Request write               0060  O_WRITE   equ    $60       Write data               0070  O_WRC     equ    $70       Write single character               0080  O_RQRD    equ    $80       Request read data               0090  O_SEND    equ    $90       Send data for read               00A0  O_INTRPT  equ    $A0       Interrupt all tasks on a terminal                     UniFLEX    Operating System (C)1     23:39:48  Dec 25, 2019   Page    9DPR        Interface                                                               global NUM_TRM,NUM_TSK                                    0002  DPR_COST  set    2         Activity cost for DPR transaction                       0000                         data                               global dpr_int                               global dpr_open,dpr_close,dpr_write,dpr_read,dpr_spcl                               global dpr_wait                       0000 00            dpr_wait  fcb    0         Count of tasks waiting for this DPR access (global)                                          *         lib     ./dpr.t                                          *                     * dpr_int - Process DPR interrupt                     *   U - FIO address                     *   Y - IOP Control structure                     *  0001 34   30       dpr_int   pshs   x,y  0003 10AE 2A                 ldy    dpr_dba,y getchip address  0006 A6   22                 lda    dpr_cpu2,y move transaction data  0008 34   02                 pshs   a         -- Transaction specific value  000A 6F   E2                 clr    ,-s       ** Filler **  000C A6   21                 lda    dpr_cpu1,y  000E 34   02                 pshs   a         -- Sequence #  0010 A6   A4                 lda    dpr_cpu,y  0012 34   02                 pshs   a         -- Response code  0014 6F   A9 03FE            clr    dpr_cpuF,y indicate message received  0018 A6   E4                 lda    0,s       get response code  001A 81   0A                 cmpa   #R_INTRPT  001C 27   09                 beq    05f                     *                     *          cmpa    #R_CLOCK   clock tick?                     *          bne     10f  001E 20   1E                 bra    10f                     * >0020 BD   0000               jsr    clkint    process clock interrupt***  Undefined symbol  0023 32   66                 leas   6,s       clean up stack  0025 20   3E                 bra    99f       exit                     *  0027 E6   61       05        ldb    1,s       relative terminal #                     *****+ 0029 BD   03A3               jsr    find_dn   compute absolute terminal #  002C BE   0000               ldx    ttytab    compute TTY table address***  Undefined symbol  002F 86   14                 lda    #TTYSIZ  0031 3D                      mul  0032 30   8B                 leax   d,x  0034 4F                      clra  0035 E6   63                 ldb    3,s       get interrupt code >0037 BD   0000               jsr    intrpt    send interrupt to this terminalUniFLEX    Operating System (C)1     23:39:48  Dec 25, 2019   Page   10DPR        Interface                                ***  Undefined symbol                     *****  003A 32   66                 leas   6,s       clean up stack  003C 20   27                 bra    99f       exit                     * 0,s - response code                     * 1,s - sequence #                     * 3,s - transaction specific returned value  003E 10AE 64       10        ldy    4,s  0041 31   2C                 leay   dpr_tran,y point to transaction list+ 0043 F6   044F               ldb    NUM_TRAN  # transactions  0046 34   04                 pshs   b  0048 A6   62       15        lda    2,s       check transaction #  004A A1   A4                 cmpa   tran_seq,y match?  004C 27   08                 beq    20f       yes - go                     *  004E 31   26                 leay   TRAN_SIZ,y next transaction  0050 6A   E4                 dec    0,s       any more?  0052 26   F4                 bne    15b                     * -- Unsolicited response!  0054 20   0F                 bra    99f       exit                     *  0056 35   04       20        puls   b         clean up stack  0058 A6   E4                 lda    0,s       get response code  005A A7   21                 sta    tran_resp,y save response code  005C A6   63                 lda    3,s       get response value  005E A7   22                 sta    tran_val,y  0060 32   66                 leas   6,s       clean up stack >0062 BD   0000               jsr    wakeup    wake up sender***  Undefined symbol  0065 35   B0       99        puls   x,y,pc    return                                          *                     * dpr_msg - Send a value via the DPR Mailbox & wait for response                     *   D - Value to send (B = Command, A = Specific data)                     *   Y - Interlock table                     *   jsr dpr_msg                     *   D - Value returned (B = Error response, A = Specific data)                     *  0067 34   77       dpr_msg   pshs   cc,d,x,y,u save registers                     * -- Find an empty transaction box  0069               10        seti   turn      off interrupts  0069 1A   50                 orcc   #F|I                               endm  006B 10AE 65                 ldy    5,s       get DPR control structure address+ 006E BD   02CB               jsr    MBX_lock  get access to DPR  0071 17   00BD               lbsr   find_slot go find a slot  0074 27   17                 beq    15f       jump if one found                     *  0076 10AE 65                 ldy    5,s       restore DPR structure pointer+ 0079 BD   0301               jsr    MBX_unlock give up DPR until slot available  007C 17   00B2               lbsr   find_slot make sure no slots available  007F 27   E8                 beq    10b       jump if there is oneUniFLEX    Operating System (C)1     23:39:49  Dec 25, 2019   Page   11DPR        Interface                                                     * sleep until one comes available  0081 10AE 65                 ldy    5,s       get DPR pointer  0084 31   25                 leay   dpr_tflg,y sleep on transaction slots  0086 C6   0F                 ldb    #IOPPRI+ 0088 BD   037E               jsr    Q_sleep   wait for available message slot  008B 20   DC                 bra    10b       try for a transaction slot                     * found free transaction slot  008D E6   00 1212  15        ldb    utask+1   set sequence # in slot ???***  Undefined symbol***  Illegal indexed mode  0091 CA   01                 orb    #1  0093 E7   A4                 stb    tran_seq,y  0095 E6   E4                 ldb    0,s       enable (old) interrupts  0097 1F   9A                 tfr    b,cc  0099 34   20                 pshs   y         save transaction slot pointer                     * put data in mailbox  009B E6   64                 ldb    4,s       restore message code  009D A6   63                 lda    3,s       restore specific data  009F 1E   03                 exg    d,u  00A1 A6   00 1212            lda    utask+1***  Undefined symbol***  Illegal indexed mode  00A5 8A   01                 ora    #1        set sequence #  00A7 E7   25                 stb    tran_dev,y  00A9 1E   03                 exg    d,u  00AB A7   23                 sta    tran_oval,y  00AD E7   24                 stb    tran_msg,y                     *  00AF 10AE 67                 ldy    7,s       restore IOP structure pointer >00B2 17   0000               lbsr   mbx_put***  Undefined symbol+ 00B5 BD   0301               jsr    MBX_unlock release mailbox                     *  00B8 35   20       20        puls   y         get transaction slot address***  Phasing error detected  00BA                         seti   mask      interrupts  00BA 1A   50                 orcc   #F|I                               endm  00BC 6D   21                 tst    tran_resp,y any response yet?  00BE 26   46                 bne    30f       yes - go process                     * wait for response to arrive  00C0 AE   65                 ldx    5,s       get IOP control address  00C2 EC   02                 ldd    dpr_fifo,x does this task own the FIFO?  00C4 26   37                 bne    25f       yes - don't allow interrupts!                     *  00C6 34   60                 pshs   y,u       save registers  00C8 FC   0000               ldd    umark1    set up to allow interruptable sleep***  Undefined symbol  00CB 34   06                 pshs   d+ 00CD 8E   00E0               ldx    #27f      interrupt handling label  00D0 34   10                 pshs   x  00D2 10FF 0000               sts    umark1UniFLEX    Operating System (C)1     23:39:49  Dec 25, 2019   Page   12DPR        Interface                                ***  Undefined symbol                     *  00D6 C6   F6                 ldb    #TTYIPR   set interruptable priority+ 00D8 BD   0381               jsr    A_sleep   wait for IOP response  00DB 35   76                 puls   d,x,y,u   restore registers  00DD BF   0000               stx    umark1    restore interrupt point***  Undefined symbol  00E0 20   24                 bra    30f       continue                     *  00E2 35   70       27        puls   x,y,u     Interrupt happened! - (D) already popped  00E4 BF   0000               stx    umark1    restore stack mark***  Undefined symbol  00E7 86   BF                 lda    #E_ABORT  aborted transaction!  00E9 A7   21                 sta    tran_resp,y  00EB C6   A0                 ldb    #O_INTRPT  00ED 34   20                 pshs   y         save transaction slot pointer  00EF 10AE 67                 ldy    7,s       restore IOP control pointer+ 00F2 BD   02CB               jsr    MBX_lock  get access to mailbox  00F5 BD   0000               jsr    mbx_put***  Undefined symbol+ 00F8 BD   0301               jsr    MBX_unlock release mailbox  00FB 35   20                 puls   y         restore transaction slot pointer  00FD 20   07                 bra    30f                     * sleep until avialable  00FF C6   0F       25        ldb    #IOPPRI  0101 34   70                 pshs   x,y,u     save registers+ 0103 BD   0381               jsr    A_sleep  0106 35   70                 puls   x,y,u     restore registers                     *  0108 BE   0000     30        ldx    utask***  Undefined symbol  010B                         seti   turn      off interrupts while fiddling with transaction slots  010B 1A   50                 orcc   #F|I                               endm                     * -- See if there is a response.  It is possible to                     * -- get here without one if an interrupt happened which                     * -- was being ignored.  In this case, the IOP doesn't                     * -- need to be notified of any interrupt, but we must                     * -- wait for the IOP response to actually arrive.  010D E6   21                 ldb    tran_resp,y get response code  010F 26   02                 bne    35f       jump if response present                     *  0111 34   20                 pshs   y         reset stack  0113 20   A1                 bra    20b       wait for response                     *  0115 4F            35        clra             release    transaction slot  0116 A7   A4                 sta    tran_seq,y  0118 6F   21                 clr    tran_resp,y  011A A6   22                 lda    tran_val,y get response value  011C ED   61                 std    1,s       set return value  011E 10AE 65                 ldy    5,s       wake anybody waiting for this slot  0121 31   25                 leay   dpr_tflg,yUniFLEX    Operating System (C)1     23:39:49  Dec 25, 2019   Page   13DPR        Interface                                  0123 BD   0000               jsr    wakeup***  Undefined symbol  0126 A6   62                 lda    2,s       interrupted transaction?  0128 81   BF                 cmpa   #E_ABORT  012A 26   03                 bne    50f       no - continue                     *  012C 10FE 0000               lds    umark1    yes - get out***  Undefined symbol  0130 39                      rts                     *  0131 35   F7       50        puls   cc,d,x,y,u,pc return                                          *                     * find_slot - find a transaction slot                     *   Y - DPR control address                     *   jsr find_slot                     *   Y - Transaction slot                     *   <NE> if none available                     *  0133 34   30       find_slot pshs   x,y       save register  0135 31   2C                 leay   dpr_tran,y point to transactions+ 0137 F6   044F               ldb    NUM_TRAN  013A 34   04                 pshs   b                     * look first for OUR transaction  013C A6   00 1212  10        lda    utask+1   check for busy entries***  Undefined symbol***  Illegal indexed mode  0140 8A   01                 ora    #1  0142 A1   A4                 cmpa   tran_seq,y  0144 27   1B                 beq    30f       yes - use it!  0146 31   26                 leay   TRAN_SIZ,y  0148 6A   E4                 dec    0,s       any more?  014A 26   EE                 bne    10b                     *  014C 10AE 63                 ldy    3,s       restore DPR pointer  014F 31   2C                 leay   dpr_tran,y point to transactions+ 0151 F6   044F               ldb    NUM_TRAN  0154 E7   E4                 stb    0,s                     * now look for free slot  0156 A6   A4       20        lda    tran_seq,y entry busy?  0158 27   07                 beq    30f       no - use it!  015A 31   26                 leay   TRAN_SIZ,y  015C 6A   E4                 dec    0,s       any more?  015E 26   F3                 bne    20b                     *  0160 86   01                 lda    #1        return NE - no slot  0162 20   01                 bra    99f                     *  0164 10AF 63       30        sty    3,s       return value  0167 4F                      clra             return     EQ - slot found                     *  0168 35   B4       99        puls   b,x,y,pc  clean stack & returnUniFLEX    Operating System (C)1     23:39:50  Dec 25, 2019   Page   14DPR        Interface                                                                          *                     *  get_F_S - Allocate a transaction slot and the FIFO                     *    Y - DPR control                     *  016A 34   77       get_F_S   pshs   cc,d,x,y,u save registers  016C                         seti   mask      interrupts  016C 1A   50                 orcc   #F|I                               endm+>016E BD   0131               jsr    find_slot allocate transaction slot  0171 27   0B                 beq    10f       jump if one found                     *  0173 10AE 65                 ldy    5,s       wait for slot  0176 31   25                 leay   dpr_tflg,y  0178 C6   0F                 ldb    #IOPPRI+ 017A BD   037E               jsr    Q_sleep  017D 35   77                 puls   cc,d,x,y,u restore registers  017F 20   E6                 bra    get_F_S   try again                     *  0181 E6   00 1212  10        ldb    utask+1   "allocate" slot***  Undefined symbol***  Illegal indexed mode  0185 CA   01                 orb    #1  0187 E7   A4                 stb    tran_seq,y  0189 35   77                 puls   cc,d,x,y,u restore interrupts/registers+ 018B 7E   032D               jmp    DPRF_lock lock DPR access                                          *                     * dpr_open - Open a channel on the IOP                     *   D = Device #                     *  018E 34   76       dpr_open  pshs   d,x,y,u  0190 17   0204               lbsr   dpr_fdv   compute device #  0193 24   FC                 bcc    00f       jump if OK to open                     **                     **        ldb     #TTYOPR    hang up task                     **        ldy     dpr_open   ** this will never happen! **                     **        jsr     sleep                     **  0195 34   66       00        pshs   d,u,y     save DPR parameters                     *  0197 C6   10       05        ldb    #O_OPEN   send "open device" request+ 0199 BD   0067               jsr    dpr_msg  019C C1   82                 cmpb   #E_SYSBSY if IOP saturated, try again  019E 26   01                 bne    10f                     *+ 01A0 BD   03AA               jsr    p_dpr_bsy print message  01A3 20   EE                 bra    05b                     *  01A5 C1   84       10        cmpb   #E_BADDEV illegal device?  01A7 26   04                 bne    15f                     *-- Hang up device - 2/20/85UniFLEX    Operating System (C)1     23:39:50  Dec 25, 2019   Page   15DPR        Interface                                                     **        ldb     #TTYOPR    hang up task                     **        ldy     dpr_open   ** this will never happen! **                     **        jsr     sleep  01A9 CC   0012               ldd    #EBDEV    yes - return error  01AC FD   0000               std    uerror***  Undefined symbol  01AF 20   06                 bra    20f                     *  01B1 10BE 0000     15        ldy    utask     set controlling terminal***  Undefined symbol  01B5 EC   2E                 ldd    tstty,y  01B7 26   FE                 bne    20f       jump if already set                     *  01B9 EC   66                 ldd    6,s       restore device code                     **        cmpb    strm       is this a terminal?                     **        bhs     20f        no - don't screw up the tables                     *                     **        ldx     ttytab     compute "TTY" table address                     **        lda     #TTYSIZ                     **        mul                     **        leax    d,x                     **        stx     tstty,y    set controlling terminal                     **        ldd     6,s        restore device #                     **        std     tdevic,x   set fake entry in TTY table  01BB 35   66       20        puls   d,u,y     clean up stack                     *  01BD 35   F6       99        puls   d,x,y,u,pc                                          *                     * dpr_close - Close a terminal at the DPR                     *  01BF 34   76       dpr_close pshs   d,x,y,u  01C1 17   01D3               lbsr   dpr_fdv   compute device #  01C4 25   0E                 bcs    99f       jump if error  01C6 34   66                 pshs   d,u,y     save IOP parameters                     *  01C8 C6   20       00        ldb    #O_CLOSE  send "close device" request+ 01CA BD   0067               jsr    dpr_msg  01CD C1   82                 cmpb   #E_SYSBSY if IOP saturated, try again  01CF 26   01                 bne    10f                     *+ 01D1 BD   03AA               jsr    p_dpr_bsy print message  01D4 20   EE                 bra    00b                     *  01D6 35   66       10        puls   d,u,y     clean up stack                     *  01D8 35   F6       99        puls   d,x,y,u,pc                                          *                     * dpr_write - Write data to a channel on the DPR                     *  01DA 34   76       dpr_write pshs   d,x,y,uUniFLEX    Operating System (C)1     23:39:50  Dec 25, 2019   Page   16DPR        Interface                                  01DC 17   01B8               lbsr   dpr_fdv   compute device #  01DF 25   4A                 bcs    99f       jump if error                     *  01E1 34   66                 pshs   d,u,y     save IOP parameters                     *  01E3 FC   0000     00        ldd    uicnt     any data left?***  Undefined symbol  01E6 27   41                 beq    90f       no - exit                     *                     **        cmpd    #1         single character write?                     **        beq     50f        yes - special case                     *  01E8 C6   50                 ldb    #O_RQWR   send "request write data" request+ 01EA BD   0067               jsr    dpr_msg  01ED C1   86                 cmpb   #E_IOERR  I/O Error? (possible on printers)  01EF 27   33                 beq    80f                     *  01F1 C1   82                 cmpb   #E_SYSBSY if IOP saturated, try again  01F3 26   01                 bne    05f                     *+ 01F5 BD   03AA               jsr    p_dpr_bsy print message  01F8 20   E5                 bra    00b                     *+ 01FA BD   0167     05        jsr    get_F_S   allocate FIFO and a transaction slot  01FD 86   00                 lda    #0        start queueing characters                     *  01FF 34   72       10        pshs   a,x,y,u   save registers                     **        lbsr    cpass      get character  0201 35   72                 puls   a,x,y,u   restore registers  0203 2B   04                 bmi    20f       jump if no more                     *  0205 BD   0000               jsr    DPRF_put  place character in FIFO***  Undefined symbol  0208 4C                      inca             update     count  0209 81   00                 cmpa   #DPRF_SIZE** Warning! Immediate value truncated  020B 26   EE                 bne    10b                     *  020D 4D            20        tsta             anything   in FIFO?  020E 27   0F                 beq    30f       no - exit                     *  0210 C6   60       25        ldb    #O_WRITE  set Write code+ 0212 BD   0067               jsr    dpr_msg   signal DPR  0215 C1   82                 cmpb   #E_SYSBSY if DPR saturated, try again  0217 26   01                 bne    27f                     *+ 0219 BD   03AA               jsr    p_dpr_bsy print message  021C 20   EE                 bra    25b                     *+ 021E BD   035F     27        jsr    DPRF_unlock release interlock  0221 20   BC                 bra    00b       continue                     *UniFLEX    Operating System (C)1     23:39:50  Dec 25, 2019   Page   17DPR        Interface                                + 0223 BD   035F     30        jsr    DPRF_unlock release FIFO  0226 20   01                 bra    90f       exit                     * -- Special case for single character write                     **50        pshs    x,y,u      save registers                     **          lbsr    cpass      fetch character from user                     **          puls    x,y,u      restore registers                     **        lda     #O_WRC     write single character                     **        exg     a,b        a=data, b=command                     **        jsr     fio_msg    issue command                     **        cmpb    #E_IOERR                     **        bne     90f                     *  0228 86   01       80        lda    #EIO      some sort of I/O error  022A B7   0000               sta    uerror***  Undefined symbol                     *  022D 35   66       90        puls   d,u,y     clean up stack                     *  022F 35   F6       99        puls   d,x,y,u,pc                                          *                     * dpr_read - Read data from a channel at the DPR                     *  0231 34   76       dpr_read  pshs   d,x,y,u  0233 17   0161               lbsr   dpr_fdv   get DPR params >0236 1025 0052               lbcs   99f       exit if error                     *  023A 34   66                 pshs   d,y,u     save DPR params                     *  023C FC   0000     00        ldd    uicnt     how many more characters needed***  Undefined symbol  023F 27   42                 beq    90f       exit if none                     *  0241 C6   80                 ldb    #O_RQRD   inform DPR we need data+ 0243 BD   0067               jsr    dpr_msg                     **        cmpb    #R_RD1C    single character returned?                     **        beq     50f        yes - go process it                     *+ 0246 BD   0167               jsr    get_F_S   allocate FIFO  0249 FC   0000               ldd    uicnt     how much data to read?***  Undefined symbol  024C 1083 0200               cmpd   #DPRF_SIZE can move no more than FIFO  0250 25   FF                 blo    05f                     *  0252 CC   0200               ldd    #DPRF_SIZE                     *  0255 1F   98       05        tfr    b,a       set request max size  0257 C6   90                 ldb    #O_SEND   tell DPR to send data  0259 34   02                 pshs   a         save size of request+ 025B BD   0067               jsr    dpr_msg  025E 81   00                 cmpa   #0        EOF?  0260 27   1A                 beq    20f       yes - go process itUniFLEX    Operating System (C)1     23:39:51  Dec 25, 2019   Page   18DPR        Interface                                                     *  0262 34   06                 pshs   a,b       save input count, response type                     *  0264 34   72       10        pshs   a,x,y,u   save registers  0266 BD   0000               jsr    DPRF_get  get character***  Undefined symbol >0269 17   0000               lbsr   passc     send to user***  Undefined symbol  026C 35   72                 puls   a,x,y,u   restore registers  026E 4A                      deca             any        more this load?  026F 26   EF                 bne    10b       yes - go get 'em                     *+ 0271 BD   035F               jsr    DPRF_unlock & release it to world  0274 35   06                 puls   a,b       a=size returned, b=response code  0276 A1   E0                 cmpa   ,s+       less than requested amount  0278 26   09                 bne    90f       exit if not the same (must be less)                     *  027A C1   0B                 cmpb   #R_SNDMC  Make sure there are more chars available  027C 27   BA                 beq    00b                     *  027E 20   03                 bra    90f       exit                     * -- DPR returned EOF+ 0280 BD   035F     20        jsr    DPRF_unlock  0283 35   02                 puls   a         clean up stack  0285 20   FC                 bra    90f       exit                     * -- Single character returned                     **50        tfr     a,b        get character                     **        pshs    x,y,u      save registers                     **        lbsr    passc move to user                     **        puls    x,y,u      restore registers  0287 35   66       90        puls   d,y,u     clean up stack                     * -- Try to even loading  0289 10BE 0000               ldy    utask***  Undefined symbol  028D 6F   A8 12              clr    tsact,y                     * --  0290 35   F6       99        puls   d,x,y,u,pc                                          *                     * dpr_spcl - Perform TTYSET/TTYGET for an DPR channel                     *  X - =0 if doing ttyset                     *     <>0 if ttyget                     *  0292 34   76       dpr_spcl  pshs   d,x,y,u  0294 17   0100               lbsr   dpr_fdv   compute device #  0297 25   30                 bcs    99f       jump if error                     *  0299 34   66       00        pshs   d,y,u     save registers+ 029B BD   0167               jsr    get_F_S   allocate FIFO and a transaction slot  029E AE   68                 ldx    6+2,s     get ttyset/get parameter  02A0 8C   0000               cmpx   #0        ttyset?  02A3 26   10                 bne    50f       no - do ttygetUniFLEX    Operating System (C)1     23:39:51  Dec 25, 2019   Page   19DPR        Interface                                                     *  02A5 86   06                 lda    #6        move ttyset data into FIFO  02A7 8E   0000               ldx    #usarg0***  Undefined symbol                     *  02AA E6   80       10        ldb    ,x+       move data  02AC BD   0000               jsr    DPRF_put  into FIFO***  Undefined symbol  02AF 4A                      deca  02B0 26   F4                 bne    10b                     *  02B2 C6   30                 ldb    #O_TTYS   send "ttyset" request+ 02B4 BD   0067               jsr    dpr_msg  02B7 20   0B                 bra    90f       exit                     *  02B9 C6   40       50        ldb    #O_TTYG   send "ttyget" request+ 02BB BD   0067               jsr    dpr_msg  02BE 86   06                 lda    #6        move data from FIFO into buffer                     *  02C0 BD   0000     60        jsr    DPRF_get  get data from FIFO***  Undefined symbol  02C3 E7   80                 stb    ,x+  02C5 4A                      deca  02C6 26   F4                 bne    60b                     *+ 02C8 BD   035F     90        jsr    DPRF_unlock release FIFO buffer  02CB 35   66                 puls   d,u,y     clean up stack                     *  02CD 35   F6       99        puls   d,x,y,u,pc                                                               *                     * MBX_lock - Lock the DPR interface                     *    Y - IOP Control address                     *  02CF 34   77       MBX_lock  pshs   cc,d,x,y,u save registers  02D1                         seti   mask      interrupts  02D1 1A   50                 orcc   #F|I                               endm  02D3 BE   0000               ldx    utask     get task pointer***  Undefined symbol  02D6 EC   A4                 ldd    dpr_mbx,y mailbox already locked?  02D8 27   01                 beq    10f       no - go check FIFO                     *  02DA 10A3 0A                 cmpd   tstid,x   locked by me?  02DD 26   05                 bne    20f       no - must wait                     *  02DF EC   22       10        ldd    dpr_fifo,y FIFO locked?  02E1 27   14                 beq    50f       no - go lock mailbox                     *  02E3 10A3 0A                 cmpd   tstid,x   locked by me?  02E6 27   0F                 beq    50f       yes - still OKUniFLEX    Operating System (C)1     23:39:51  Dec 25, 2019   Page   20DPR        Interface                                                     *+ 02E8 7C   0000     20        inc    dpr_wait  02EB C6   0F                 ldb    #IOPPRI  02ED 34   20                 pshs   y         preserve register+ 02EF BD   037E               jsr    Q_sleep   yes - sleep until available  02F2 35   20                 puls   y         restore register+ 02F4 7A   0000               dec    dpr_wait  02F7 35   77                 puls   cc,d,x,y,u restore environ  02F9 20   D0                 bra    MBX_lock  try again                     *  02FB EC   0A       50        ldd    tstid,x   lock mailbox  02FD ED   A4                 std    dpr_mbx,y+ 02FF 6F   A9 0001            clr    dpr_int,y no missed interrupts                     *  0303 35   F7       99        puls   cc,d,x,y,u,pc return                                          *                     * MBX_unlock - unlock the DPR interface                     *                     *    Y - IOP Control address                     *  0305 34   77       MBX_unlock pshs  cc,d,x,y,u  0307                         seti   turn      off interrupts  0307 1A   50                 orcc   #F|I                               endm+ 0309 A6   A9 0001            lda    dpr_int,y did we miss an interrupt?  030D 27   FF                 beq    05f       no - continue                     *+ 030F BD   0001               jsr    dpr_int   yes - pretend we're seeing it now!                     *+ 0312 6F   A9 0001  05        clr    dpr_int,y reset flag  0316 CC   0000               ldd    #0  0319 ED   A4                 std    dpr_mbx,y reset lock  031B BD   0000               jsr    wakeup    wake up anybody waiting on this IOP***  Undefined symbol  031E 10AE 65                 ldy    5,s       restore pointer+ 0321 B6   0000               lda    dpr_wait  was anybody waiting?  0324 27   05                 beq    10f       no - exit  0326 BE   0000               ldx    utask     reset priority***  Undefined symbol  0329 BD   0000               jsr    fixpri***  Undefined symbol  032C BD   0000               jsr    change    let somebody else run***  Undefined symbol                     *  032F 35   F7       10        puls   cc,d,x,y,u,pc return                                          *                     * DPRF_lock - Lock the DPR FIFO buffer                     *    Y - DPR Control address                     *  0331 34   77       DPRF_lock pshs   cc,d,x,y,u save registersUniFLEX    Operating System (C)1     23:39:52  Dec 25, 2019   Page   21DPR        Interface                                  0333                         seti   mask      interrupts  0333 1A   50                 orcc   #F|I                               endm  0335 BE   0000               ldx    utask     get task pointer***  Undefined symbol  0338 EC   22                 ldd    dpr_fifo,y FIFO locked?  033A 27   01                 beq    10f       no - go check mailbox                     *  033C 10A3 0A                 cmpd   tstid,x   locked by me?  033F 26   05                 bne    20f       no - must wait                     *  0341 EC   A4       10        ldd    dpr_mbx,y mailbox already locked?  0343 27   14                 beq    50f       no - go lock FIFO                     *  0345 10A3 0A                 cmpd   tstid,x   locked by me?  0348 27   0F                 beq    50f       yes - still OK                     *  034A C6   0F       20        ldb    #IOPPRI+ 034C 7C   0000               inc    dpr_wait  mark somebody waiting  034F 34   20                 pshs   y         save pointer+>0351 BD   037E               jsr    Q_sleep   yes - sleep until available  0354 35   20                 puls   y         restore pointer+ 0356 7A   0000               dec    dpr_wait  0359 35   77                 puls   cc,d,x,y,u restore environ  035B 20   00                 bra    FIFO_lock try again***  Undefined symbol                     *  035D EC   0A       50        ldd    tstid,x   lock FIFO  035F ED   22                 std    dpr_fifo,y                     *  0361 35   F7       99        puls   cc,d,x,y,u,pc return                                          *                     * DPRF_unlock - unlock the DPR FIFO buffer                     *                     *    Y - IOP Control address                     *  0363 34   77       DPRF_unlock pshs cc,d,x,y,u  0365                         seti   turn      off interrupts  0365 1A   50                 orcc   #F|I                               endm  0367 CC   0000               ldd    #0  036A ED   22                 std    dpr_fifo,y reset lock  036C BD   0000               jsr    wakeup    wake up anybody waiting on this FIFO***  Undefined symbol  036F 10AE 65                 ldy    5,s       restore pointer+ 0372 B6   0000               lda    dpr_wait  was anybody waiting?  0375 27   05                 beq    10f       no - exit  0377 BE   0000               ldx    utask     reset priority***  Undefined symbol  037A BD   0000               jsr    fixpri***  Undefined symbolUniFLEX    Operating System (C)1     23:39:52  Dec 25, 2019   Page   22DPR        Interface                                  037D BD   0000               jsr    change    let somebody else run***  Undefined symbol                     *  0380 35   F7       10        puls   cc,d,x,y,u,pc return                                          *                     * Q_sleep - Sleep until event with decreased activity                     *  0382 7E   0000     Q_sleep   jmp    sleep***  Undefined symbol                                          *                     * A_sleep - Sleep until event with no decrease in activity                     *  0385 BD   0000     A_sleep   jsr    sleep     wait for event***  Undefined symbol  0388 34   12                 pshs   a,x       upgrade activity  038A BE   0000               ldx    utask***  Undefined symbol  038D A6   88 12              lda    tsact,x  0390 8B   02                 adda   #DPR_COST  0392 24   FE                 bcc    00f                     *  0394 86   FF                 lda    #$FF                     *  0396 A7   88 12    00        sta    tsact,x  0399 35   92                 puls   a,x,pc                                          *                     * dpr_fdv - Find device info for DPR channel                     *    D - device #                     *    jsr dpr_fdv                     *    B - device # (0..N)                     *    U - Sequence #/Terminal #                     *    Y - FIO interlock                     *    <Carry> if illegal device #                     *  039B 34   06       dpr_fdv   pshs   d         save device #  039D EE   E4                 ldu    0,s       get device code+ 039F 108E 03CB               ldy    #DPR0  03A3 1C   FE                 clc              no         error  03A5 35   86       99        puls   d,pc      return                                          *                     * find_dn - compute device # for a channel on an DPR                     *   B - relative device #                     *   Y - IOP control address                     *   jsr find_dn                     *   D - absolute device #                     *  03A7 34   76       find_dn   pshs   d,x,y,u   save registers  03A9 4F                      clraUniFLEX    Operating System (C)1     23:39:52  Dec 25, 2019   Page   23DPR        Interface                                  03AA ED   E4                 std    0,s       set return value  03AC 35   F6                 puls   d,x,y,u,pc return                     *  03AE 34   76       p_dpr_bsy pshs   d,x,y,u+ 03B0 8E   03BB               ldx    #00f  03B3 BD   0000               jsr    Pdata***  Undefined symbol  03B6 8E   FFFF               ldx    #$FFFF  03B9 30   1F       10        leax   -1,x  03BB 26   F8                 bne    10b                     *  03BD 35   F6       99        puls   d,x,y,u,pc                     *  03BF 0D 44 50 52   00        fcc    $d,'DPR Saturated!',0                                                                         define  03CF 00 00 00 00   DPR0      rzb    DPR_SIZE                       0453 00            NUM_TRAN  fcb    0         #transactions allowed                                                    enddef                               enddef  0454                         end** Warning! End statement in LIB file ignored                     +              0454  dpr_ctl   equ    *  0454 00 00         mbxlck    rzb    2  0456 00 00         fiflck    rzb    2  0458 00            intcnt    rzb    1  0459 00            tactwt    rzb    1  045A 00 00 00 00   resp_Q    rzb    4  045E E000          dpradd    fdb    $e000  0460 00 00 00 00   tranlst   rzb    DPR_MXTR*TRAN_SIZE                                                               +              04D8  start     equ    *                     + 04D8 CE   0454               ldu    #dpr_ctl  04DB CC   E000               ldd    #DPRFLP  04DE ED   4A                 std    dpr_dba,u                     *  04E0 34   30                 pshs   x,y  04E2 AE   4A                 ldx    dpr_dba,u  04E4 A6   89 03FE            lda    dpr_cpuF,x  04E8 12                      nop  04E9 10AE 88 13              ldy    dpr_f_put,x  04ED E7   A0                 stb    0,y+                                            04EF 20   FE                 bra    *UniFLEX    Operating System (C)1     23:39:52  Dec 25, 2019   Page   24DPR        Interface                                                     +                              end    start51 Error(s) detected     2 Warning(s) reported     8 Excessive BRANCH/JUMP(S) detectedLength of Text Segment: 0000Length of Data Segment: 04F1Length of Bss Segment:  0000UniFLEX    Operating System (C)1     23:39:52  Dec 25, 2019   Page   25DPR        Interface                                Symbol Table:Absolute Symbols:ALARMS   000A   BARGS    0007   BASACI   F000   BSECH    0020   BSPCH    007F   BUFPR    0032   BUFSIZ   0200   CBIT     0001   CDBLKS   0064   CFDN     0032   CLKCON   0001   CLKLAT   F004   CLKMSK   0080   CLKSEL   F005   CLOCK    F004   CNCLC    0018   CNTRL    0080   CPUID    18A5   CPUTYP   0003   CR       000D   CRMOD    0010   DATBOX   F400   DELCR    000C   DELFF    0020   DELNL    0003   DELTB    0010   DELVT    0020   DEV2IRQ  03FF   DIRSIZ   000E   DPLCNT   000A   DPLSIZ   0009   DPRFLP   E000   DPRF_SIZ 0200   DPRPRI   000F   DPR_COST 0002   DPR_MXTR 0014   DPR_SIZE 0084   DRVPAG   0009   DSKADS   0003   EARGC    0013   EBADF    0007   EBARG    000C   EBBIG    0016   EBDCL    001A   EBDEV    0012   EBIT     0080   EBSY     0010   ECHO     0002   EDFUL    0005   EDTOF    0003   EFAULT   0002   EFLX     000B   EINTR    001B   EIO      0001   EISDR    0014   ELOCK    001F   EMSDR    0009   EMT2S    0008   EMTS     0004   ENBLK    000F   ENCHD    0018   ENDR     0004   ENMNT    0011   ENOFL    0008   ENOTB    0015   ENTSK    001C   ENTTY    001D   EOTCH    0004   EPIPE    001E   EPRM     000A   ESCOFF   0080   ESEEK    000D   ESTOF    0017   ETMFL    0006   ETMTS    0019   EXCSIZ   0008   EXDEV    000E   E_ABORT  00BF   E_BADCMD 0081   E_BADDEV 0084   E_DEVBSY 0085   E_INTRPT 00BE   E_IOERR  0086   E_NTOPEN 0083   E_SYSBSY 0082   F        0040   FALTS    0007   FDNPR    0064   FIFO_SIZ 0080   GPP      0000   HANGS    0001   HOLD     0002   HOLDC    001B   HZTIM    0009   I        0010   INTRC    0003   INTS     0002   INTSIZ   000D   IOP0TTY  F200   IOP1TTY  F300   IOP2IRQ  00FF   IOPPRI   000F   IOP_MAP  00F8   IOP_SIZE 012A   IO_DAT   F40E   IO_MAP   00FE   IRQ2DEV  03FE   IRQ2IOP  00FE   KILLS    0005   LB_BLKIO 0008   LB_IDLE  0001   LB_SWOUT 0004   LB_SWPIN 0002   LCASE    0008   LIGHTS   F006   MAPSIZ   000D   MAXJOB   0014   MAXPAG   0100   MAXPAGES 0010   MAXPIP   1000   MAX_TRAN 0030   NBLKS    0010   NFDNPR   0050   NL       000A   NODEV    FFFF   NUM_CL   F2FA   NUM_NEC  F2FC   NUM_PPR  F2FD   NUM_TRM  F2FB   NUM_TSK  F2F9   NWP0DEV  E400   OQHI     0077   OQLO     000F   O_CLOSE  0020   O_INTRPT 00A0   O_OPEN   0010   O_RQRD   0080   O_RQWR   0050   O_SEND   0090   O_TTYG   0040   O_TTYS   0030   O_WRC    0070   O_WRITE  0060   PAGSIZ   1000   PIPEPR   FFFB   QUITC    001C   QUITS    0003   RAW      0001   REGSIZ   0008   REJECT   0080   RESTM    0009   ROM_VERS 0012   R_CLOSE  0003   R_INTRPT 000A   R_OPEN   0002   R_RD1C   0009   R_RDOK   0007   R_REQOK  0004   R_RESET  0001   R_SNDMC  000B   R_SNDNC  0008   R_TTY    0006   R_WRITE  0005   SBUF     000C   SBUFFR   C000   SCHR     0040   SIGCNT   000C   SLEPPR   FFB0   SMAPSZ   0100   SPACE    0020   SPI0DEV  E000   SSIZE    0001   STABPG   0001   STKOFS   0F3E   STKREG   000E   SWAPPR   0078   SYSBLK   000F   SYSLOC   0000   SYSPAG   0000   SYSSTK   BF3E   SYSTXT   0005   TABCH    0009   TARGX    0020   TCORE    0001   TCREAT   0004   TIMES    0009   TIMOUT   0001   TLOCK    0002   TNOMAP   0040   TOPEN    0004   TOPWOC   0010   TRACS    0008   TRAN_SIZ 0006   TRUN     0001   TSKSIZ   001D   TSLEEP   0002   TSWAPO   0010   TSYSTM   0004   TTERM    0005   TTRACE   0006   TTRACP   0008   TTYIPR   FFF6   TTYOPR   FFEC   TTYSIZ   0014   TWAIT    0003   UA       0001   UB       0002   UCC      0000   UD       0001   UNFILS   0010   UPB      0007   UPC      0005   USERBL   BF3E   USERPR   FFA6   USRHIP   000F   USRHIP_4 00F0   USRHIP_F 00FC   USRLOC   000B   USTKO    0E00   UX       0003   WAITPR   FFD8   WBUFPR   001E   WMEMPR   FFFB   WPIPES   0006   XANY     0020   UniFLEX    Operating System (C)1     23:39:53  Dec 25, 2019   Page   26DPR        Interface                                XBUF     000D   XBUFFR   D000   XOFFC    0013   XONC     0011   XONXOF   0040   XTABS    0004   cpu_dpr  0008   cpu_dpr1 0009   cpu_dpr2 000A   cpu_dpr3 000B   cpu_dpr4 000C   cpu_dpr5 000D   cpu_dpr6 000E   cpu_dpr7 000F   cpu_dprF 03FF   cpu_iop  F204   cpu_iop1 F205   cpu_iop2 F206   cpu_iop3 F207   cpu_iopF F2FF   cuddwn   FE01   dpr_Q    0006   dpr_cpu  0000   dpr_cpu1 0001   dpr_cpu2 0002   dpr_cpu3 0003   dpr_cpu4 0004   dpr_cpu5 0005   dpr_cpu6 0006   dpr_cpu7 0007   dpr_cpuF 03FE   dpr_dba  000A   dpr_f_cn 0010   dpr_f_ge 0011   dpr_f_pu 0013   dpr_fgpp 03FC   dpr_fifo 0002   dpr_gen  03FF   dpr_intc 0004   dpr_mbx  0000   dpr_tflg 0005   dpr_tgpp 03FD   dpr_tran 000C   dprf     0020   fifo     F210   fifo_cnt F208   fifo_get F209   fifo_put F20B   inbrbu   0007   inbrmsk  0005   indev    000B   inhand   0009   inmask   0002   inrbrg   0007   inspcl   0001   instat   0003   intbrg   0005   intype   0000   iop_Q    0006   iop_cpu  F200   iop_cpu1 F201   iop_cpu2 F202   iop_cpu3 F203   iop_cpuF F2FE   iop_fifo 0002   iop_int  0004   iop_mbx  0000   iop_tflg 0005   iop_tran 000A   irq_gen  F2FF   k_u_map  FE02   taddr    0006   tbaud    0010   tbaud2   0011   tbksp    000E   tcncl    000F   tcolm    000D   tdel     000C   tdelay   0009   tdevic   000A   tflags   0008   timctrl  F005   timdata  F004   tlatch   FE03   tqin     0000   tqout    0004   tqproc   0002   tran_dev 0005   tran_msg 0004   tran_ova 0003   tran_res 0001   tran_seq 0000   tran_val 0002   trpctrl  F007   trpdata  F006   tsact    0012   tsage    0013   tsalrm   001B   tsevnt   0014   tslink   0000   tsmode   0006   tsprb    0011   tsprir   0007   tssgnl   0010   tssize   001A   tsslnk   0002   tsstat   0005   tsswap   0018   tstat2   0013   tstate   0012   tstext   0016   tstid    000A   tstidp   000C   tstty    000E   tsuid    0008   tsutop   0004   Text Segment Symbols:     NoneData Segment Symbols:A_sleep  0381   DPR0     03CB   DPRF_loc 032D   DPRF_unl 035F   MBX_lock 02CB   MBX_unlo 0301   NUM_TRAN 044F   Q_sleep  037E   dpr_clos 01BB   dpr_ctl  0454   dpr_fdv  0397   dpr_int  0001   dpr_msg  0067   dpr_open 018A   dpr_read 022D   dpr_spcl 028E   dpr_wait 0000   dpr_writ 01D6   dpradd   045A   fiflck   0452   find_dn  03A3   find_slo 0131   get_F_S  0167   intcnt   0454   mbxlck   0450   p_dpr_bs 03AA   resp_Q   0456   start    04D8   tactwt   0455   tranlst  045C   Bss Segment Symbols:     NoneExternal Symbols:     None